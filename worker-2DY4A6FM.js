addEventListener("message",({data:t})=>{n(t.file,t.retryCount).then(e=>postMessage({success:!0,result:e})).catch(e=>postMessage({success:!1,file:t.file,error:e}))});async function n(t,e){let r="http://kubernetes.docker.internal:5001/api/file/upload",a=new FormData;a.append("file",t);for(let o=1;o<=e;o++)try{let s=await fetch(r,{method:"POST",headers:{"Access-Control-Allow-Origin":"*"},body:a});if(!s.ok)throw new Error(`Upload failed with status ${s.status}`);return await s.json()}catch(s){if(o===e)throw s;console.warn(`Upload attempt ${o} failed. Retrying...`)}}
